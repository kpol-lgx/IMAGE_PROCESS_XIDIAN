# GNN 的详细调查
## Abstract
近年来，深度学习彻底改变了许多机器学习任务，从图像分类和视频处理到语音识别和自然语言理解。这些任务中的数据通常在欧几里得空间中表示。
然而，越来越多的应用程序从非欧几里德领域生成数据，并表示为具有复杂关系和对象之间相互依赖性的图形。图数据的复杂性对现有的机器学习算法提出了重大挑战。
最近，出现了许多关于扩展图数据深度学习方法的研究。在本次调查中，我们全面概述了数据挖掘和机器学习领域中的图神经网络 (GNN)。我们提出了一种新的分类法，将最先进的图神经网络分为四类，即：
1. recurrent graph neural networks
2. convolutional graph neural networks
3. graph autoencoders
4. spatial-temporal graph neural networks

我们进一步讨论了图神经网络在各个领域的应用，
并总结了图神经网络的开源代码、基准数据集和模型评估。最后，我们提出了这个快速发展领域的潜在研究方向。

## 一、引言
神经网络的成功推动了模式识别和数据挖掘的研究。许多机器学习任务，如对象检测、机器翻译、语音识别，曾经严重依赖手工特征工程来提取信息特征集，最近已经发生了革命性的变化。这主要归功于各种端到端深度学习范例，例如卷积神经网络 (CNNs) 、递归神经网络 (RNNs) 和自动编码器。深度学习在许多领域的成功部分归功于快速发展的计算资源（例如 GPU）、大训练数据的可用性以及深度学习从欧几里得数据（例如图像、文本、和视频）提取潜在表示的高效性。以图像数据作为例，我们可以将图像表示为欧几里德空间中的规则网格。卷积神经网络 (CNN) 能够利用图像数据的移位不变性、局部连通性和组合性。因此，CNN 可以提取局部有意义的特征，这些特征与整个数据集共享，用于各种图像分析。

虽然深度学习有效地捕获了欧几里德数据的隐藏模式，但越来越多的应用程序将数据以图的形式表示。例如，在电子商务中，基于图的学习系统可以利用用户和产品之间的交互来做出高度准确的推荐。在化学中，分子被建模为图，并且需要确定它们的生物活性以用于药物发现。在引文网络中，论文通过引用关系相互链接，并且需要将它们分类到不同的组中。图数据的复杂性对现有的机器学习算法提出了重大挑战。由于图可能是不规则的，因此图可能具有可变大小的无序节点，并且图中的节点可能具有不同数量的邻居，从而导致一些重要的操作（例如，卷积）在图像域中易于计算，但是很难应用于图域。此外，现有机器学习算法的一个核心假设是实例相互独立。这个假设不再适用于图数据，因为每个实例（节点）都通过各种类型的链接与其他实例相关，例如引用、友谊和交互。

最近，人们对扩展图形数据的深度学习方法越来越感兴趣。在 CNN、RNN 和深度学习的自动编码器的推动下，在过去几年中，重要操作的新概括和定义得到迅速发展，以处理图形数据的复杂性。例如，图卷积可以从 2D 卷积推广。如图 1 所示，可以将图像视为图的特例，其中像素由相邻像素连接。类似于 2D 卷积，可以通过取节点邻域信息的加权平均值来执行图卷积。

## 二、背景和定义

### A. 背景
**图神经网络简史(GNNs)**。Sper duti 等人 (1997) 首先将神经网络应用于有向无环图，这激发了对 GNN 的早期研究。Gori 等人最初概述了图神经网络的概念 (2005) 并在 Scarselli 等人中进一步阐述 (2009) 和 Gallicchio 等人 (2010)。这些早期研究属于循环图神经网络 (RecGNN) 类别。他们通过以迭代方式传播邻居信息来学习目标节点的表示，直到达到稳定的固定点。这个过程在计算上是昂贵的，最近人们越来越努力地克服这些挑战。

受 CNN 在计算机视觉领域取得成功的鼓舞，大量重新定义图形数据卷积概念的方法被同时开发。这些方法属于卷积图神经网络 (ConvGNN) 的范畴。 ConvGNN 分为两个主要流，基于光谱的方法和基于空间的方法。Bruna 等人提出了第一个关于基于光谱的 ConvGNN 的突出研究 (2013)，它开发了一种基于谱图理论的图卷积。从那时起，基于光谱的 ConvGNN 的改进、扩展和近似不断增加。基于空间的 ConvGNN 的研究比基于光谱的 ConvGNN 起步更早。2009 年，Micheli 等人首先通过架构复合非递归层解决图相互依赖，同时继承从 RecGNN 传递消息的想法。然而，这项工作的重要性被忽视了。直到最近，出现了许多基于空间的 ConvGNN。具有代表性的 RecGNN 和 ConvGNN 的时间线显示在表 II 的第一列中。除了 RecGNN 和 ConvGNN，过去几年还开发了许多替代 GNN，包括图自动编码器 (GAE) 和时空图神经网络 (STGNN)。这些学习框架可以建立在 RecGNN、ConvGNN 或其他用于图形建模的神经架构上。关于这些方法分类的详细信息在第 III 节中给出。

网络嵌入是另一个越来越受到数据挖掘和机器学习社区关注的话题。网络嵌入旨在将网络节点表示为低维向量表示，同时保留网络拓扑结构和节点内容信息，以便可以使用简单的现成方法轻松执行任何后续图分析任务，如分类、聚类和推荐。货架机器学习 算法（例如，用于分类的支持向量机）。同时，GNN 是深度学习模型，旨在以端到端的方式解决与图相关的任务。许多 GNN 显式提取高级表示。

GNN 和网络嵌入之间的主要区别在于，GNN 是一组为各种任务设计的神经网络模型，而网络嵌入涵盖了针对同一任务的各种方法。因此，GNN 可以通过图形自动编码器框架解决网络嵌入问题。另一方面，网络嵌入包含其他非深度学习方法，例如矩阵分解[33]、 [34]和随机游走[35]。

图神经网络与图核方法图核是解决图分类问题的历史主导技术[36]、[37]、 [38]。这些方法使用核函数来衡量图对之间的相似性，因此支持向量机等基于核的算法可用于图的监督学习。

与 GNN 类似，图核可以通过映射函数将图或节点嵌入向量空间。不同之处在于这个映射函数是确定性的而不是可学习的。由于成对相似性计算，图核方法受到计算瓶颈的严重影响。

### B. 定义
在本文中，我们使用粗体大写字符表示矩阵，使用粗体小写字符表示向量。循环图神经网络（RecGNNs）大多是图神经网络的先驱。RecGNN 旨在学习具有递归神经架构的节点表示。 

表 I：常用符号。

除非特别说明，否则本文中使用的符号如表 I 所示。现在我们定义理解本文所需的最小定义集。

定义 1（图）：图表示为 G = (V, E)，其中 V 是顶点或节点的集合（我们将在整篇论文中使用节点），E 是边的集合。令 $v_i$ ∈ V 表示一个节点， $e_{ij} = (v_i , v_j )$ ∈ E 表示从$v_j$指向$v_i$的边。节点 v 的邻域定义为 N(v) = {u ∈ V | (v, u) ∈ E}。邻接矩阵 A 是一个 n × n 矩阵，如果 $e_{ij}$ ∈ E，则 $A_{ij} = 1$ ，如果 $e_{ij}$ ∈/ E，则 $A_{ij} = 0$。图可能具有节点属性 X，其中 X ∈ Rn×d是节点特征矩阵，其中 xv ∈ Rd表示同时， Xe ∈ Rm×c为边
的图可能具有边属性 Xe 特征矩阵，其中 x ∈ Rc表示边 (v, u) 的特征向量。

定义2（有向图）：有向图是所有边从一个节点指向另一个节点的图。无向图被认为是有向图的特例，如果两个节点相连，则存在一对方向相反的边。当且仅当邻接矩阵是对称的时，图是无向的。

定义3（时空图）：时空图是节点属性随时间动态变化的属性图。时空图定义为 G(t) = (V, E, X(t)) 其中 X(t) ∈ Rn×d 。

## 三、分类和框架
在本节中，我们介绍了图神经网络 (GNN) 的分类，如表II 所示。我们将图神经网络 (GNN) 分为循环图神经网络 (RecGNN)、卷积图神经网络 (Con vGNN)、图自动编码器 (GAE) 和时空图神经网络 (STGNN)。图 2 给出了各种模型架构的示例。下面，我们对每个类别进行简要介绍。

### A. 图神经网络 (GNN) 的分类
循环图神经网络（RecGNNs）大多是图神经网络的先驱。 RecGNN 旨在学习具有递归神经架构的节点表示。他们假设图中的一个节点不断地与其邻居交换信息/消息，直到达到稳定的平衡到达。RecGNN 在概念上很重要，并启发了后来对卷积图神经网络的研究。特别是，基于空间的卷积图神经网络继承了消息传递的思想。

卷积图神经网络（ConvGNNs）概括了从网格数据到图数据的卷积操作。主要思想是通过聚合自身的特征xv和邻居的特征xu 来生成节点 v 的表示，其中 u ∈ N(v)。与 RecGNN 不同，ConvGNN 堆叠多个图形卷积层以提取高级节点表示。ConvGNN 在构建许多其他复杂的 GNN 模型中发挥着核心作用。图2a显示了用于节点分类的 ConvGNN。图2b演示了用于图形分类的 ConvGNN。

图自动编码器 (GAE)是无监督学习框架，它将节点/图编码到潜在向量空间中，并从编码信息中重建图数据。 GAE 用于学习网络嵌入和图形生成分布。对于网络嵌入，GAE 通过重建图形结构信息（例如图形邻接矩阵）来学习潜在节点表示。对于图生成，一些方法逐步生成图的节点和边，而另一些方法一次输出一个图。图2c展示了用于网络嵌入的 GAE。

时空图神经网络 (STGNN)旨在从时空图中学习隐藏模式，这在交通速度预测[72]、驾驶员机动预测[73]和人类行为识别等各种应用中变得越来越重要[ 75]。 STGNN的关键思想是同时考虑空间依赖性和时间依赖性。当前许多集成图卷积的方法通过RNN 或 CNN 捕获空间依赖性来对时间依赖性进行建模。图2d说明了用于时空图预测的 STGNN。

### B. 框架
以图结构和节点内容信息作为输入，GNN 的输出可以通过以下机制之一专注于不同的图分析任务：

- **节点级**